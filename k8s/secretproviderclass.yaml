apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: gke-fastapi-prod-sm
  namespace: gke-fastapi-prod
spec:
  provider: gcp
  parameters:
    # 4â€“5 lines explanation:
    # "secrets" lists Secret Manager objects to mount into the pod.
    # Each entry maps a Secret Manager secret version to a file name.
    # This avoids storing secrets in GitHub or plain Kubernetes manifests.
    # Access is controlled by Workload Identity + IAM on the Google SA.
    secrets: |
      - resourceName: "projects/YOUR_PROJECT_ID/secrets/API_KEY/versions/latest"
        fileName: "API_KEY"
